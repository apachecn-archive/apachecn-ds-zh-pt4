

# 九、展示数据

这一章讨论了交流我们分析结果的不同方式。在这里，我们将看看不同的表现风格以及可视化技术。这一章的重点是利用我们的结果，并能够以连贯、易懂的方式解释它们，以便任何人，无论他们是否精通数据，都可以理解和使用我们的结果。

我们将讨论的大部分内容是如何通过标签、键、颜色等创建有效的图形。我们还将研究更高级的可视化技术，例如平行坐标图。

在本章中，我们将探讨以下主题:

*   识别有效和无效的可视化
*   识别图表何时试图“欺骗”观众
*   能够识别因果关系和相关性
*   构建吸引人的视觉效果，提供有价值的见解

# 为什么沟通很重要？

能够用编码语言进行实验和操纵数据还不足以进行实际的和应用的数据科学。这是因为，一般来说，数据科学的好坏取决于它在实践中的应用。例如，一名医学数据科学家可能能够以 98%的准确率预测发展中国家的游客感染疟疾的几率，但是，如果这些结果发表在营销不善的期刊上，并且网上对该研究的提及很少，那么他们可能会防止死亡的突破性结果将永远不会出现。

因此，结果的交流可以说和结果本身一样重要。一个著名的成果分配管理不善的例子是格雷戈尔·孟德尔。孟德尔被公认为现代遗传学的创始人之一。然而，他的成果(包括数据和图表)直到他死后才被很好地采纳。孟德尔甚至把它们寄给了查尔斯·达尔文，达尔文在很大程度上忽略了孟德尔的论文，这些论文是在不知名的摩拉维亚期刊上发表的。

一般来说，有两种呈现结果的方式:口头和视觉。当然，语言和视觉形式的交流都可以细分成几十个子类别，包括幻灯片、图表、期刊论文，甚至大学讲座。然而，我们可以找到数据表示的共同元素，这些元素可以使该领域的任何人在他们的沟通技巧方面更加了解和有效。

让我们直接进入有效(和无效)的交流形式，从视觉开始。



# 识别有效和无效的可视化

数据可视化的主要目标是让读者快速消化数据，包括可能的趋势、关系等等。理想情况下，读者不必花费超过 5-6 秒的时间来消化一个可视化。因此，我们必须非常认真地制作视觉效果，并确保我们制作的视觉效果尽可能好。让我们来看看四种基本类型的图表:散点图、折线图、条形图、直方图和箱线图。

## 散点图

散点图可能是最简单的图表之一。它是通过创建两个*定量*轴，并使用数据点来表示观察值。散点图的主要目的是突出两个变量之间的关系，如果可能的话，揭示相关性。

例如，我们可以看两个变量:一天看电视的平均小时数和 0-100 分的工作表现(0 表示表现很差，100 表示表现优秀)。这里的目标是找到看电视和平均工作表现之间的关系(如果存在的话)。

以下代码模拟了对几个人的调查，在调查中，他们根据公司标准的工作绩效指标，透露了平均每天看电视的时间:

```
import pandas as pd
hours_tv_watched = [0, 0, 0, 1, 1.3, 1.4, 2, 2.1, 2.6, 3.2, 4.1, 4.4, 4.4, 5]
```

这行代码创建了 14 个样本调查结果，这些结果是关于人们一天看多少小时电视的问题。

```
work_performance = [87, 89, 92, 90, 82, 80, 77, 80, 76, 85, 80, 75, 73, 72]
```

这一行代码创建了 14 个新的样本调查结果，对同一批人的工作表现进行评分，范围从 0 到 100。

例如，第一个人每天看 0 个小时的电视，工作得分为 87/100，而最后一个人平均每天看 5 个小时的电视，工作得分为 72/100:

```
df = pd.DataFrame({'hours_tv_watched':hours_tv_watched, 'work_performance':work_performance})
```

这里，我们创建了一个数据框架，以简化我们的探索性数据分析，并使更容易制作散点图:

```
df.plot(x='hours_tv_watched', y='work_performance', kind='scatter')
```

现在，我们实际上是在做散点图。在下面的图中，我们可以看到我们的坐标轴代表一天看电视的小时数和这个人的工作绩效指标:

![Scatter plots](graphics/B05260_09_01.jpg)

散点图上的每个点代表一个观察值(在本例中是一个人)，其位置是观察值在每个变量上所处位置的结果。这个散点图似乎显示了一种关系，这意味着当我们一天看更多的电视时，它似乎会影响我们的工作表现。

当然，由于我们现在是上两章的统计专家，我们知道这可能不是因果关系。散点图可能只能揭示两者之间的相关性或关联性，而不是因果关系。高级统计测试，比如我们在[第八章](ch08.html "Chapter 8. Advanced Statistics")、*高级统计*中看到的，可能会揭示因果关系。在这一章的后面，我们将看到信任相关性可能产生的破坏性影响。

## 线形图

线图可能是数据通信中最广泛使用的图之一。折线图只是用线条连接数据点，通常在 x 轴上表示时间。折线图是一种显示变量随时间变化的流行方式。线形图和散点图一样，用于绘制*定量*变量。

举个很好的例子，我们很多人都想知道我们在电视上看到的和我们在这个世界上的行为之间可能的联系。我的一个朋友曾经将这种想法发挥到了极致——他想知道是否能在电视节目、《X 档案》和美国 UFO 目击事件的数量之间找到联系..然后他找到了每年目击不明飞行物的次数，并绘制了它们随时间的变化图。然后，他添加了一个快速图表，以确保读者能够识别 X 档案发布的时间点:

![Line graphs](graphics/B05260_09_02.jpg)

来源:[http://www . questioned-economics . com/what-do-we-know-about-aliens/](http://www.questionable-economics.com/what-do-we-know-about-aliens/)

很明显，就在 1993 年 X 档案首映后，UFO 目击事件的数量开始急剧攀升。

这张图虽然轻松，却是简单线图的一个极好的例子。我们被告知每个轴测量什么，我们可以很快看到数据的总体趋势，我们可以认同作者的意图，即显示 UFO 目击数量和 X 档案总理之间的关系。

另一方面，下面是一个不太令人印象深刻的折线图:

![Line graphs](graphics/B05260_09_03.jpg)

这个线形图试图通过绘制三个时间点来突出汽油价格的变化。乍一看，它与之前的图表没有太大的不同——我们在底部的 *x* 轴上显示时间，在垂直的 *y* 轴上显示数量值。这里(不那么)细微的区别是这三个点在 *x* 轴上等距分布；然而，如果我们阅读它们的实际时间指示，它们在时间上并不是等间隔的。前两点相隔一年，而后两点相隔仅 7 天。

## 条形图

当试图比较不同组的变量时，我们通常会求助于条形图。例如，我们可以使用条形图来绘制每个大洲的国家数量。注意 *x* 轴并不代表一个定量变量，实际上在使用条形图时， *x* 轴一般是一个分类变量，而 *y* 轴是定量变量。

请注意，对于此代码，我使用的是世界卫生组织关于世界各国酒精消费量的报告:

```
drinks = pd.read_csv('data/drinks.csv')

drinks.continent.value_counts().plot(kind='bar', title='Countries per Continent')
plt.xlabel('Continent')
plt.ylabel('Count')
```

下图显示了各大洲的国家数量。我们可以在条形的底部看到洲代码，条形的高度代表我们在每个洲的国家数量。例如，我们看到，在我们的调查中，非洲国家最多，而南美国家最少:

![Bar charts](graphics/B05260_09_04.jpg)

除了国家计数，我们还可以使用条形图绘制每个大洲的平均啤酒用量，如下所示:

```
drinks.groupby('continent').beer_servings.mean().plot(kind='bar')
```

![Bar charts](graphics/B05260_09_05.jpg)

请注意散点图或线形图无法支持该数据，因为它们只能处理定量变量；条形图能够展示分类值。

我们还可以使用条形图来绘制随时间变化的变量，如线形图。

## 直方图

直方图显示了单个定量变量的频率分布，通过将数据按范围分割成等距的*箱*，并绘制每个箱中观察值的原始计数。直方图实际上是一个条形图，其中 *x* 轴是一个值箱(子范围),而 *y* 轴是一个计数。例如，我将导入一家商店每天的独立客户数量，如下所示:

```
rossmann_sales = pd.read_csv('data/rossmann.csv')

rossmann_sales.head()
```

![Histograms](graphics/B05260_09_06.jpg)

注意我们是如何拥有个多商店数据的(通过第一个`Store`列)。让我们只对第一家商店的数据进行子集划分，如下所示:

```
first_rossmann_sales = rossmann_sales[rossmann_sales['Store']==1]
```

现在，让我们绘制第一家商店顾客数量的直方图:

```
first_rossmann_sales['Customers'].hist(bins=20)
plt.xlabel('Customer Bins')
plt.ylabel('Count') 
```

![Histograms](graphics/B05260_09_07.jpg)

*x* 轴现在是分类的，因为每个类别都是一个选定范围的值，例如，600-620 个客户可能是一个类别。像条形图一样， *y* 轴描绘了每个类别中的观察数量。例如，在该图中，人们可能会忽略这样一个事实，即在大多数情况下，任何一天的客户数量都会在 500 到 700 之间。

总之，直方图用于可视化定量变量可以呈现的值的分布。

### 注意

在直方图中，我们不在条形之间放置空格。

## 箱形图

箱形图也用于显示数值分布。它们是通过绘制五个数字摘要创建的，如下所示:

*   最小值
*   第一个四分位数(将 25%最低值与其他值分开的数字)
*   中间值
*   第三个四分位数(将 25%的最高值与其他值分开的数字)
*   最大值

在 Pandas 中，当我们创建盒状图时，红线表示中间值，盒的顶部(或右侧，如果是水平的)是第三个四分位数，盒的底部(左侧)是第一个四分位数。

以下是一系列显示各大洲啤酒消费分布的方框图:

```
drinks.boxplot(column='beer_servings', by='continent')
```

![Box plots](graphics/B05260_09_08.jpg)

现在，我们可以清楚地看到七大洲啤酒消费的分布以及它们之间的差异。非洲和亚洲的啤酒消费中位数比欧洲或北美低得多。

箱线图还有一个额外的好处，就是能够比直方图更好地显示异常值。这是因为最小值和最大值是箱线图的一部分。

回到客户数据，让我们看看同样的商店客户数量，但使用的是箱线图:

```
first_rossmann_sales.boxplot(column='Customers', vert=False)
```

![Box plots](graphics/B05260_09_09.jpg)

这与之前在直方图中绘制的数据完全相同；但是，现在显示为箱线图。为了便于比较，我将逐一展示两张图表:

![Box plots](graphics/B05260_09_10.jpg)![Box plots](graphics/B05260_09_11.jpg)

请注意每幅图的 *x* 轴是如何相同的，范围从 0 到 1200。箱形图更快地给出了数据的中心，红线是中间值，而直方图更好地向我们展示了数据的分布情况以及人们最大的箱子在哪里。例如，直方图显示有一个非常大的零人的容器。这意味着在 150 多天的数据中，没有客户。

注意，我们可以使用 Pandas 中的`describe`特性获得的精确数字来构建一个方框图，如下所示:

```
first_rossmann_sales['Customers'].describe()

min         0.000000
25%       463.000000
50%       529.000000
75%       598.750000
max      1130.000000
```



# 当图表和统计数据说谎时

我要明确一点，统计不会说谎，人会说谎。欺骗你的观众的最简单的方法之一就是混淆相关性和因果性。

## 相关性与因果性

我不认为我会被允许出版这本书而不深入探究相关性和因果性之间的区别。对于这个例子，我将继续使用我的电视消费和工作表现的数据。

**相关性**是介于-1 和 1 之间的量化指标，用于衡量两个变量*如何相互移动*。如果两个变量的相关性接近于-1，这意味着随着一个变量增加，另一个变量减少，如果两个变量的相关性接近于+1，这意味着这些变量向同一个方向移动——一个变量增加，另一个变量也增加，反之亦然。

**因果关系**是一个变量影响另一个变量的观点。

例如，我们可以看两个变量:一天看电视的平均小时数和 0-100 分的工作表现(0 是非常差的表现，100 是优秀的表现)。人们可能会认为这两个因素是负相关的，这意味着随着一天 24 小时中看电视的时间增加，你的整体工作表现会下降。回想一下前面的代码，如下所示:

```
import pandas as pd
hours_tv_watched = [0, 0, 0, 1, 1.3, 1.4, 2, 2.1, 2.6, 3.2, 4.1, 4.4, 4.4, 5]
```

在这里，我在看和之前一样的 14 个人的样本，以及他们对问题的回答，*你平均每晚看几个小时的电视*:

```
work_performance = [87, 89, 92, 90, 82, 80, 77, 80, 76, 85, 80, 75, 73, 72]
```

这是前面提到的 14 个人，顺序相同，但是现在，我们用公司或第三方系统对他们的工作表现进行评级，而不是他们看电视的时间:

```
df = pd.DataFrame({'hours_tv_watched':hours_tv_watched, 'work_performance':work_performance})
```

早些时候，我们看了这两个变量的散点图，它似乎清楚地显示了变量之间的下降趋势——随着电视消费的上升，工作表现似乎下降。然而，相关系数，一个介于-1 和 1 之间的数字，是一个很好的方法来确定变量之间的关系，同时，量化它们并对它们的强度进行分类。

现在我们可以引入一行新的代码，向我们展示这两个变量之间的相关性:

```
df.corr() # -0.824
```

回想一下，相关，如果接近-1，意味着强负相关，而接近+1 的相关意味着强正相关。

这个数字有助于支持假设，因为相关系数接近-1 不仅意味着负相关，而且还意味着强相关。同样，我们可以通过两个变量之间的散点图看到这一点。所以，我们的视觉和数字是一致的。这是一个重要的概念，在交流结果时应该如此。如果你的视觉效果和数据不佳，人们就不太可能认真对待你的分析:

![Correlation versus causation](graphics/B05260_09_12.jpg)

我再怎么强调相关性和因果性是互不相同的。相关性只是量化了变量一起变化的程度，而因果关系是一个变量实际上决定了另一个变量的值。如果你希望分享你相关工作的发现结果，你可能会遇到听众中的挑战者，要求做更多的工作。更可怕的是，可能没有人知道分析是不完整的，你可能会根据简单的相关性工作做出可操作的决策。

通常情况下，两个变量可能相互关联，但它们之间没有任何因果关系。这可能有多种原因，其中一些原因如下:

*   他们之间可能有一个*混淆因素*。这意味着还有第三个潜在的变量没有被考虑在内，它作为两个变量之间的桥梁。例如，之前，我们表明你可能会发现你看电视的时间与工作表现负相关，即随着你看电视的小时数增加，你的整体工作表现可能会下降。这是一种相关性。认为看电视是工作表现质量下降的真正原因似乎不太正确。似乎更合理的说法是，有第三个因素，也许是每晚数小时的睡眠，可以回答这个问题。也许，看更多的电视会减少你的睡眠时间，从而限制你的工作表现。每晚的睡眠时间是混淆因素。
*   他们可能彼此没有任何关系！这可能只是一个巧合。有许多变量是相互关联的，但并不互为因果。考虑下面这个例子:![Correlation versus causation](graphics/B05260_09_13.jpg)

更有可能的是，这两个变量只是碰巧与奶酪消费量决定了世界上土木工程博士的数量相关联(我可以补充一下，这比我们之前的例子更强)。

你可能听说过这样的说法*相关性并不意味着因果关系*，最后一张图表正是数据科学家必须相信这一点的原因。仅仅因为变量之间存在数学相关性，并不意味着它们之间有因果关系。他们之间可能有混淆的因素，或者他们之间可能没有任何关系！

让我们看看当我们忽略混杂变量和相关性变得极其误导时会发生什么。

## 辛普森悖论

辛普森悖论是我们需要认真对待混杂变量的正式理由。悖论指出，当我们考虑不同的因素时，两个变量之间的相关性可以完全颠倒。这意味着，即使图表可能显示正相关，当考虑到另一个因素(很可能是混杂因素)时，这些变量也可能成为*反相关*。这对统计人员来说可能非常麻烦。

假设我们希望探索两个不同闪屏页面之间的关系(回想一下我们之前在[第 7 章](ch07.html "Chapter 7. Basic Statistics")、*基本统计*中的 A/B 测试)。我们将这些页面再次称为页面 A 和页面 B。我们有两个闪屏页面，我们希望进行比较和对比，我们选择的主要指标将是我们的转化率，就像前面一样。

假设我们运行一个初步测试，发现以下转换结果:

| 

第一页

 | 

第二页

 |
| --- | --- |
| 75% (263/350) | 83% (248/300) |

这意味着网页 B 的转换率比网页 a 高 10%。所以，很明显，网页 B 是更好的选择，因为它的转换率更高。如果我们将这些数据传达给我们的同事，看起来我们是清白的！

然而，让我们看看当我们也考虑用户更接近的海岸时会发生什么，如下所示:

|   | 

第一页

 | 

第二页

 |
| --- | --- | --- |
| 西海岸 | **95% (76 / 80)** | 93% (231/250) |
| 东海岸 | **72% (193/270)** | 34% (17/50) |
| 两者 | 75% (263/350) | **83% (248/300)** |

这就是悖论！当我们按位置分解样本时，似乎页面 A 在两个类别中都更好，但总体上更差。这就是这个悖论的美妙之处，也是它的可怕之处。出现这种情况是因为四个群体之间的阶级不平衡。

页面 A /东海岸组和页面 B /西海岸组提供了样本中的大多数人，因此使结果偏离预期。这里的混淆变量可能是这样一个事实，页面在一天的不同时间给出，西海岸的人更有可能看到页面 B，而东海岸的人更有可能看到页面 a。

辛普森悖论有一个解决方案(因此也有一个答案)，然而，证明存在于贝叶斯网络的复杂系统中，有点超出了本书的范围。

从辛普森悖论中得到的主要启示是，我们不应该过度赋予相关变量以因果关系。可能会有混淆的变量需要检查。因此，如果你能够揭示两个变量之间的相关性(如网站类别和对话率或电视消费和工作表现)，那么你绝对应该尽可能多地隔离可能是相关性原因或至少有助于进一步解释你的情况的变量。

## 如果相关性不意味着因果关系，那是什么呢？

作为一名数据科学家，处理相关性而无法得出结论性的因果关系通常令人沮丧。确信获得因果关系的最佳方式通常是通过随机实验，比如我们在第 8 章、*高级统计学*中看到的那些实验。人们必须将人群分成随机抽样的群体，并进行假设检验，以在一定程度上确定变量之间存在真正的因果关系。



# 言语交流

除了数据的视觉展示，口头交流在展示结果时也同样重要。如果您不仅仅是上传结果或发布，您通常会向一屋子的数据科学家、高管或会议厅展示数据。

在任何情况下，当进行口头陈述时，都有一些关键领域需要关注，尤其是当陈述是关于数据的发现时。

口头陈述通常有两种风格:一种是针对更专业的环境，包括公司办公室，在那里手头的问题通常与公司业绩或其他一些 **KPI** ( **关键业绩指标**)直接相关，另一种则更多地针对一屋子的同事，其主要想法是激发听众关心你的工作。

## 这是关于讲一个故事

无论是正式的还是随意的介绍，人们都喜欢听故事。当你展示结果时，你不仅仅是吐出事实和数据，你还试图让你的听众相信并关心你要说的内容。

做演讲时，时刻注意你的听众，试着判断他们对你所讲内容的反应/兴趣。如果他们似乎没有参与，试着将问题与他们联系起来:

*“想想看，当像《权力的游戏》这样受欢迎的电视节目回归时，你的员工将会花更多的时间看电视，因此他们的工作表现会更差*”

现在你引起了他们的注意。这是关于和你的听众的关系，不管是你的老板还是你妈妈的朋友；你必须想办法让它变得有意义。

## 在事物更正式的一面

当向更正式的观众展示数据时，我喜欢坚持以下六个步骤:

1.  Outline the state of the problem.

    在这一步中，我们回顾问题的当前状态，包括问题是什么以及问题是如何引起数据科学家团队的注意的。

2.  Define the nature of the data.

    在这里，我们更深入地讨论这个问题影响到谁，解决方案将如何改变这种情况，以及以前在这个问题上所做的工作(如果有的话)。

3.  Divulge an initial hypothesis.

    在这里，我们在做任何工作之前陈述我们认为的解决方案。这可能看起来像是一种更新手的演示方法；然而，这可能是一个很好的时机，不仅可以概述你最初的假设，还可以概述整个公司的假设。例如，“我们进行了一项民意调查，61%的公司认为看电视的时间和工作表现之间没有关联”。

4.  Describe the solution and, possibly, the tools that led to the solution.

    深入了解你是如何解决问题的，使用了哪些统计测试，以及在解决问题的过程中做了哪些假设。

5.  Share the impact that your solution will have on the problem.

    谈谈你的解决方案是否与最初的假设不同。这对未来意味着什么？我们如何针对该解决方案采取行动来改善我们自己和我们的公司？

6.  Future steps.

    分享针对该问题可以采取的未来措施，例如如何实现上述解决方案以及该研究引发了哪些进一步的工作。

通过遵循这些步骤，我们可以触及数据科学方法的所有主要领域。在正式演讲中，你首先要想到的是行动。你希望你的话和解决方案是可操作的。项目完成后必须有一条清晰的道路，并应定义未来的步骤。



# 展示的原因/方式/策略

在不太正式的层面上发言时,“为什么/如何/做什么”策略是一种快速简单的方式来创建一个值得称赞的陈述。这很简单，如下所示:

1.  告诉你的听众为什么这个问题很重要，而不要真正进入你实际在做什么。
2.  然后，进入你如何处理这个问题，使用数据挖掘、数据清理、假设检验等等。
3.  最后，告诉他们你的成果对观众意味着什么。

这种模式是借用了著名的广告。那种他们甚至不会在三秒钟前告诉你产品是什么的。他们想抓住你的注意力，然后，最终，揭示是什么让你如此兴奋。考虑下面的例子:

“大家好，我在这里告诉你们为什么当奥运会正在播出时，我们似乎很难专注于我们的工作。在挖掘调查结果并将这些数据与公司标准的工作表现数据合并后，我能够发现每天看电视的小时数与平均工作表现之间的相关性。知道了这一点，我们就能更好地意识到我们看电视的习惯，并确保不让它影响我们的工作。谢谢大家。”

这一章实际上是这样格式化的！我们从*为什么*我们应该关心数据通信开始，然后我们讨论了*如何*完成它(通过关联、视觉等等)，最后，我告诉你什么，*哪个*是为什么/如何/什么策略(在此插入令人兴奋的音效)。



# 总结

数据通信不是一件容易的事情。理解数据科学如何工作的数学是一回事，但试图让一屋子的数据科学家和非数据科学家相信你的结果及其对他们的价值是完全不同的另一回事。在这一章中，我们复习了基本的图表制作，以及如何识别错误的原因和磨练我们口头表达技巧的能力。

我们接下来的几章将真正触及数据科学最大的话题之一。在前九章中，我们讨论了如何获取数据、清理数据和可视化数据，以便更好地理解数据所代表的环境。

然后，我们转向研究基本的和高级的概率/统计定律，以便使用可量化的定理和对我们数据的测试来获得可操作的结果和答案。

在后续章节中，我们将研究机器学习以及机器学习表现良好和表现不佳的本质。当我们进入这个材料的旅程时，我敦促你，读者，保持开放的心态，真正理解机器学习是如何工作的，以及我们为什么需要使用它。