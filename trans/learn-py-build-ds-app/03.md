        

# 二、编码的第一步——变量和数据类型

设置好所有工具后，您现在就可以开始开发了。启动 Jupyter——在这一章中，我们将用代码弄脏我们的手！我们将从变量的概念开始，学习如何在 Python 中分配和使用。我们将讨论命名它们的最佳实践，包括严格的要求和一般约定。接下来，我们将介绍 Python 的基本*数据类型*和它们支持的操作符，包括整数、十进制数(浮点数)、字符串和布尔值。每种数据类型都有相应的行为、键入规则、内置方法，并与某些运算符一起工作。

在本章的最后，我们将通过编写自己的假期预算计算器来把我们学到的一切付诸实践。

本章涵盖的主题如下:

*   分配变量
*   命名变量
*   了解数据类型
*   转换数据类型
*   锻炼

        

# 技术要求

你可以在`Chapter02/first_code.ipynb`笔记本里按照这一章的代码。不需要额外的包，只需要 Python。

您可以通过以下链接找到代码，该链接位于 GitHub 存储库中的`Chapter02`文件夹中([https://GitHub . com/packt publishing/Learn-Python-by-Building-Data-Science-Applications](https://github.com/PacktPublishing/Learn-Python-by-Building-Data-Science-Applications))。

重要提示:在这一章和许多其他章节中，我们将包括代码片段和交互式Shell，类似于你的代码在 Jupyter 中的样子。为了区分我们运行的代码和输出，在每个有交互的代码块中，运行的代码将在三个大于符号(`>>>`)的*之后开始，类似于它在 Python 控制台中的呈现方式。对了，你...*

        

# 分配变量

在前一章的结尾，为了测试，我们运行了一个简单的 Python 函数:

```
print('Hello world!')
```

这里，`"Hello world"`是一个自变量，即用作函数输入的数据点。在这个特例中，我们使用了一个原始数据值。然而，这种方法不会让我们走得太远——如果我们需要改变这个值，或者在其他代码中使用它呢？这可以通过使用变量来实现！

**变量**是编程中最基本也是最强大的概念之一。你可以把它们想象成别名，类似于数学方程中的变量。变量是代码中实际底层数据的表示，它允许我们在不知道代码将操作的确切值的情况下编写操作和描述关系。这使得我们可以编写通用的代码，可以在不同的情况下多次使用。

为了给变量赋值，我们使用等号(`=`)，如下面一行代码所示:

```
<variable_name> = <value>
```

看一下这些例子，它们显示了用来给变量赋值的等号:

```
pi = 3.14159265359    # Decimal
name = ‘Philipp'      # Text
age = 31              # Integer
sky_is_blue = True    # Boolean
```

注意与代码在同一行的`#`符号后的文本。这些是评论。它们被代码忽略了(因为它们前面有符号),对于解释代码、记下想法或评论特定的解决方案非常有用。大多数编辑器，包括 VS Code 和 Jupyter，都用*命令* / *Ctrl* + */* 快捷键对整行进行注释和取消注释。

一旦变量被赋值，它就会在整个会话期间存储在机器的内存中，直到脚本执行结束或者笔记本的内核关闭。现在我们可以在代码中使用它们:

```
>>> print(pi)
3.14159265359

```

有时，通过使用 packing *、*在同一行上分配几个变量会很方便，这使得代码可读性更好:

```
>>> x, y = 10, 5
>>> print(x)
10

>>> print(y)
5
```

我们总是可以通过使用相同的过程来重新分配变量:

```
>>> pi = 'Philipp'
>>> print(pi)
Philipp
```

重新分配也可以通过打包来完成，就像这样:`x, y = y, x`。

如果一个变量没有被定义，那么 Python 会抛出一个错误。这是一个典型的 Jupyter 新手错误:人们倾向于跳过笔记本中带有变量赋值的单元格。下面是一个示例代码块:

```
>>> print(non_existent_variable)

---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-1-4e13ec8d6c49> in <module>()
----> 1 print(non_existent_variable)
NameError: name 'non_existent_variable' is not defined
```

除了前面代码片段中使用的符号之外，整数和浮点数还有其他的定义方式。出于可读性的考虑，整数可以使用下划线(`_`)来标记千位数，例如`ten_million = 10_000_000`。如果值小于 1，例如，`small = .25`，浮点型不需要这个第一个零。最重要的是，floats 支持科学符号，例如，`sci_thousand = 10e3`。

        

# 命名变量

命名变量似乎是一个次要的话题，但是请相信我们，养成正确命名的好习惯将会为您节省大量的时间和精力。尽最大努力明智且一致地命名变量。不明确的名称会使代码非常难以阅读、理解和调试，这是没有道理的。

现在，从技术上讲，对变量名只有三个要求:

*   不能使用保留字:`False`、`class`、`finally`、`is`、`return`、`None`、`continue`、`for`、`lambda`、`try`、`True`、`def`、`from`、`nonlocal`、`while`、`and`、`del`、`global`、`not`、`with`、`as`、`elif`、`if`、`or`、`yield`、`assert`。您也不能使用运算符或特殊符号(`+`、`-`、`/`、`*`、`%`、`=`、`<`、`>`、`@`、`&`)或括号和圆括号...

        

# 了解数据类型

编程中的每个数据点都有一种类型。这个类型定义了分配了多少内存、值的行为方式、Python 允许你对它做什么操作等等。理解不同数据类型的属性对于 Python 中的有效编程至关重要。

您可以随时使用另一个内置函数`type()`来检查值的类型:

```
>>> type(pi)
float

>>> type(name)
str

>>> type(age)
int

>>> type(sky_is_blue)
bool
```

我们可以看到，`pi`是浮点，`name`是字符串，`age`是整数，`sky_is_blue`是布尔值。这四种类型代表了 Python 中内置的最流行的数据类型。第五个是`None`(属于`NoneType`类型):一个值的数据类型，它代表什么(一个不存在的值)。还有一些数据类型，比如复数，但我们不会在本书中使用。

        

# 浮点数和整数

浮点数和整数分别表示带小数部分和不带小数部分的有理数。这些类型使用起来非常直观，因为它们可以被加上*、*、*、*乘、除等等。让我们看看下面的例子。首先，我们分配两个变量:

```
A = 6B = 5
```

现在，让我们检查一些可能的操作:

```
>>> A + B11>>> A - B1>>> A / B1.2>>> A * B30
```

您也可以使用双星号来提高数字的幂:

```
>>> 2**38>>> 3**29
```

您可能已经注意到，两个整数的除法运算会产生一个浮点数。即使余数为零，也会发生这种情况:

```
>>> 10 / 25.0
```

如果需要将整数除法结果保持为整数(四舍五入，如果需要的话)，那么用双斜杠代替；这次行动...

        

# 具有自分配的操作

大多数操作符可以被修改以允许变量自赋值。例如，如果我们想通过添加`1`来更新`count`变量，那么我们可以写一个更简单的符号:

```
count += 1 # instead of cound = count + 1
```

同样的方法也适用于其他运营商:

```
count -= 1
count *= 2
count /= 2
count //= 2
count **= 2
count %= 4
```

正如你所看到的，如果我们不得不对一个变量进行重复操作，带有自赋值的操作符是很有用的。

        

# 执行顺序

执行顺序与标准算术计算一样。这意味着我们可以在代码中使用括号:

```
>>> (2 + 10) / 26.0>>> 10 / (1 + 1)5.0
```

可以有任意数量的嵌套括号。

        

# 用线串

字符串代表任何类型的文本。因为 Python 需要区分代码(它应该执行什么)和字符串(数据)，所以字符串必须用引号括起来:单引号、双引号或三个单引号。最后一个选项可以用于多行文本，而前两个选项只能用于同一行。

我们来看一些例子。这是一个用单引号括起来的字符串。在这种情况下，您可以在文本字符串中使用双引号，这不会破坏解析机制:

```
text1 = ‘This is a so-called “speakeasy”'
```

这里有一个类似的双引号的例子。在这种情况下，我们可以在文本中使用单引号，而不会破坏代码:

```
text2 = “This is Sam's Tavern”
```

最后，三个单引号允许我们编写多行文本:

```
text3 = ''' This is Sam's Tavern.
 "Welcome everyone!" - is written on the door.'''
```

输入多行文本的另一种方法是在文本中的同一行使用特殊的换行符(`\n`):

```
>>> print('Hello\nWorld!')
Hello
World!
```

字符串不适用于大多数操作符。唯一的例外是加法和乘法。加法将连接两个字符串，而乘法(乘以整数)将重复字符串:

```
>>> ‘Hello' + ‘ World!'
'Hello World!'

>>> ‘Hello' * 3
'HelloHelloHello'
```

但是，字符串确实有多个内置方法。方法本质上是附加到特定对象的函数，其行为通常依赖于该对象。方法是由数据类型或对象的类定义的。以下是字符串最有用的方法。`upper`、`lower`和`title`方法帮助我们改变字符串的大小写:

```
>>> “Hello World”.upper()
'HELLO WORLD'

>>> “Hello World”.lower()
'hello world'

>>> “hello world”.title()
'Hello World'
```

另一种方法`replace`返回匹配值被替换的字符串:

```
>>> “Hello world”.replace(“world”, “planet”)
'Hello planet'
```

类似地，`find`和`rfind`方法提供了一种便捷的方法来查找初始字符串中匹配字符串的第一个匹配项的索引。`find`提供从开头开始的索引，而`rfind`从结尾开始查找:

```
>>> 'To be or not to be'.find('be') 
3

>>> 'To be or not to be'.rfind('be')
16
```

最后，`startswith`和`endswith`方法将返回`True`或`False`(本章稍后将详细介绍这些值)，这取决于您的基本字符串以哪个开头或结尾:

```
>>> 'To be or not to be'.startswith('T')
True

>>> 'To be or not to be'.startswith('t')
False
```

字符串还支持其他一些方法。

        

# 格式化

有多种方法可以将字符串格式化成您想要的格式。

例如，`.rjust`和`.ljust`格式化字符串的长度，如果需要，分别在右边和左边添加符号:

```
>>> ‘hello'.rjust(10, ' ') '     hello'>>> ‘hello'.ljust(10, ' ')'hello     '
```

类似地，`.zfill`在字符串的开头添加零:

```
>>> ‘999'.zfill(10)'0000000999'
```

另一个重要的选项是使用格式化将值嵌入到现有的字符串中。事实上，这非常方便，因为它允许我们嵌入任何类型的值，而无需显式地将它们转换为字符串，此外，还可以定义表示规则并将其放置到位。有几种方法可以做到这一点。我们来看看吧！

        

# 格式方法

一个字符串的 format 方法将把它的参数注入到字符串中，替换由花括号定义的字段。特定的字段可以通过数字(在这种情况下，您只需保持参数的相同顺序)或通过使用关键字来定义。以下是一些例子:

1.  以下示例没有放置策略，只有简单的花括号:

```
>>> ‘Hello {} world and our blue {}'.format(‘beautiful', ‘planet') 'Hello beautiful world and our blue planet'
```

2.  以下示例使用数字顺序(注意顺序的变化和模板中的重复):

```
>>> ‘{0} {2} {1} and our {2} {3}!'.format('Hello','World','Beautiful', 'Planet')
'Hello Beautiful World and our Beautiful Planet!'
```

3.  以下示例使用了关键字:

```
>>> ‘Hello {adj} world!'.format(adj='beautiful')
'Hello beautiful world!'
```

就个人而言，我们更喜欢最后一个，因为它是明确的，并防止任何错误的论点的立场。然而，还有一种方法可以随时格式化字符串:通过 F 字符串。

        

# f 弦

f 字符串是 Python 相对较新的特性。它们在 3.6 版本中发布，既优雅又执行更快，因为一切都是在移动中计算的。下面是一个例子(注意起始单引号符号前的字母`f`):

```
>>> adj = ‘beautiful'>>> f'Hello {adj} world!'Hello beautiful world
```

花括号内的所有内容实际上都是可执行代码。在这个括号内，您可以使用算术甚至运行函数:

```
>>> N = 99>>> f'{N-1} bottles of milk on the wall.''98 bottles of milk on the wall.'>>> name = 'pHILIPP'>>> f'Hello mr{name.title()}''Hello mr. Phillipp'
```

        

# 传统格式

最后，我们想展示一种传统的格式化方式，它使用百分比符号。这种方法早于 Python 3。不要使用它——只要意识到它存在，并且可以在一些旧的代码库中看到。当然，这种方法没有什么特别的错误，但它被认为是一种遗产。主观上，我们认为它可读性较差，但这是我们的个人观点:

```
>>> name = 'David'
>>> print('Hello mr. %s' % name)
Hello mr. David
```

        

# 格式化小语种

在所有情况下，您都可以通过使用 Python 的**格式化小型语言**来格式化注入的值。只需在花括号中的表达式后添加一个冒号，然后写下迷你语言符号。举个例子:

```
>>> pct = .345>>> value = 45500>>> f‘Price grew by {pct:.1%} or ${value:,}''Price grew by 34.5% or 45,500'
```

关于 Python 格式化语言的更多信息可以通过官方文档([https://docs.python.org/3/library/string.html#formatspec](https://docs.python.org/3/library/string.html#formatspec))获得。

        

# 字符串作为序列

Python 也将字符串视为序列。我们将在[第 4 章](9a022822-e79e-4132-808b-4e569046e0a7.xhtml)、*数据结构*和[第 5 章](70925645-d2c1-4540-8aa6-4a2db1a9413c.xhtml)、*循环和其他复合语句*中深入讨论序列。一般来说，字符串可以被视为有序的字符数组，允许我们遍历，逐个获取字符，使用切片来获取子字符串，并检查它是否包含子字符串。

Python 中的所有索引都是整数，从零开始。如果我们想得到一个字符串的第一个符号，那么我们应该使用 index `0`:

```
>>> “Hello World”[0]
'H'
```

这里，值后的方括号表示**限幅**。我们还可以使用冒号(`:`)指定要检索的字符的子序列，以及开始和结束索引的子序列。在这种情况下，将包括对应于第一个索引的字符，但不包括最后一个:

```
>>> “Hello World”[0:5]
'Hello'
```

最后，因为字符串是序列，我们可以通过使用`in`关键字来找出一个字符串是否包含另一个字符串:

```
>>> “World” in “Hello World!”
True
```

        

# 布尔运算

布尔值只能有两个值中的一个:要么是`False`要么是`True`。它们用于描述逻辑操作，例如，测试或条件。有一些运算会产生布尔值:

*   首先，您可以对任何类型的数据使用相等测试:

```
>>> 'World' == 'World'True >>> pi == piTrue
```

*   在上一节中，我们遇到了另一个例子，即包含测试:

```
>>> “World” in “Hello World!”True
```

*   `!=`等于的反义词，不等于:

```
>>> pi != piFalse
```

还有更多测试运算符，包括大于(`>`)、小于(`<`)、大于等于(`>=`)、小于等于(`<=`)和不等(`<>`)。这些测试也可以通过字典上的比较来处理字符串。Python 会比较顺序...

        

# 逻辑运算符

有四种逻辑运算符专门处理布尔值:

*   `!`—`NOT`关键字(结果值的倒数):

```
>>> not (5 > 4)
False
```

Jupyter 将开头带有感叹号的单元格解释为终端命令，所以我们不能在那里使用它。

*   `|`—`OR`关键字(一个或另一个，或两个值):

```
>>> (5 > 4) | (6 < 5)
True
```

*   `&`—`AND`关键字(一个和另一个值):

```
>>> (5 > 4) & (6 < 5)
False
```

*   `^`—`XOR`关键字(一个或另一个，但不是两个值):

```
>>> (5 > 4) ^ (5 < 6)
False
```

以下是处理布尔数组的内置函数:

*   `all()`:只有当所有元素都是`True`时，才会返回 true
*   `any()`:如果至少有一个元素为`True`，则返回 true

Python 具有强类型—它不隐式转换数据类型。唯一的例外是对`True` / `False`的测试:任何数据类型在任何测试中都将作为布尔值工作，遵循以下一般规则:虽然在测试中使用这样的变量看起来不错，但要小心；它经常引入错误，例如，如果你想让变量在测试中是`None`，但是它作为空字符串返回。如果你不确定，最好检查一个具体的值。

零位(`float`和`int`)、空字符串和`None`在测试中表现为`False`。其他都表现为`True`。考虑这个例子:

```
>>> not ''
True
>>> bool('')
False
```

我们将在第四章、*数据结构*中讨论数组和其他结构的工作。

        

# 转换数据类型

通常，需要将一种数据类型转换成另一种数据类型，比如将浮点数转换成整数，或者将字符串转换成数字。别担心！使用内置函数很容易实现。但是，有一些转换规则需要学习。浮点型字符串如下所示:

```
>>> float(“2.5”)2.5
```

字符串到整数的转换如下:

```
>>> int(“45”)45
```

从浮点到整数以及从整数到浮点的转换如下:

```
>>> int(4.521)4>>> float(5)5.0
```

整数、浮点和字符串的布尔值如下:

```
>>> int(True)1>>> float(False)0.0>>> str(True)'True'
```

如果 Python 不能转换值，那么它将引发一个错误:

```
>>> int(“2.5”)File "<ipython-input-11-cf753495344d>", line 1 int(“2.5”) ^SyntaxError: invalid character in ...
```

        

# 锻炼

作为一个实际的练习，让我们解决一个简单而又烦人的问题:将摄氏温度转换成华氏温度，然后再转换回来。的确，公式很简单，但是每次我们需要在脑子里做的时候，都要花一些时间。这些公式如下:

```
T(°F) = T(°C) × 9/5 + 32

T(°C) = (T(°F) - 32) × 5/9
```

让我们计算一下 100 华氏度的摄氏度当量！

首先，让我们将常量和输入存储为变量:

```
CONST = 32
RATIO = 5/9

T_f = 100
```

现在，让我们进行转换:

```
>>> T_c = (T_f - CONST) * RATIO
>>> T_c
37.77777777777778
```

现在，让我们把它转换回来:

```
>>> T_f2 = (T_c / RATIO) + CONST
>>> T_f2
100.0
```

对于不同的温度，计算以下代码的最简单方法是什么？看起来最简单的方法就是改变变量的初始值，其他的都应该跟着做。让我们运行 70 F 的代码:

```
>>> T_f = 70
>>> T_c = (T_f - CONST) * RATIO
>>> T_c
21.11111111111111
```

相当整洁！在下一章，我们将学习如何通过把它写成一个函数来使这个计算更加方便和易于重用。

        

# 摘要

在本章中，我们学习了变量的概念。我们现在知道如何分配和更新变量，并使用它们作为函数参数。接下来，我们学习了 Python 的基本数据类型，它们代表文本、数字和逻辑值。每种数据类型的行为不同，使用不同的运算符。我们不得不逐个检查它们，并执行代码片段。这包括数值运算、计算顺序、字符串方法和逻辑运算。因此，在本章的最后一节，我们能够计算特定问题的答案，并生成一个简单的文本报告。

在下一章中，我们将首先回顾我们的解决方案，并讨论如何实现它...

        

# 问题

1.  为什么我们需要在代码中使用变量？
2.  推荐的变量命名方式是什么？为什么重要？
3.  数据类型是什么意思，为什么它们对计算很重要？
4.  Python 中最流行的四种数据类型是什么？
5.  `@`运算符代表什么？为什么不管用？
6.  处理字符串的两个运算符是什么？
7.  如果我们需要返回一个`True`值，但是只有当两个测试都返回`True`时，你如何组合两个测试的结果？当至少有一个人返回`True`的时候呢？如果只有一个(而不是两个)返回`True`呢？

        

# 进一步阅读

成为一名开发者你需要知道的一切都可以在这里找到:[https://docs.python.org/3/library/string.html#formatspec](https://docs.python.org/3/library/string.html#formatspec)。